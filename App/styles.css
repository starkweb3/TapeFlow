:root{--bg-light:#f4f7f8;--calc-bg-light:#fff;--display-bg-light:#fff;--history-bg-light:#fff;--key-bg-light:#fff;--key-shadow-light:rgba(0,0,0,0.08);--text-light:#333;--text-secondary-light:#777;--accent-light:#ade2ff;--accent-darker-light:#19acff;--accent-text-light:#109dff;--accent-text-equals-light:#fff;--number-text-light:#38b9ff;--function-text-light:#777;--border-light:#eee;--history-value-light:#555;--history-op-light:#aaa;--history-result-light:var(--accent-text-light);--history-border-light:#d0d0d0;--subtotal-text-light:#6ab5ff;--subtotal-border-light:var(--history-border-light);--edit-border-light:var(--accent-text-light);--confirm-light:#52c41a;--cancel-light:#ff4d4f;--confirm-hover-bg-light:#e6ffed;--cancel-hover-bg-light:#fff1f0;--bg-dark:#121212;--calc-bg-dark:#1c1c1c;--display-bg-dark:#1c1c1c;--history-bg-dark:#1c1c1c;--key-bg-dark:#2a2a2a;--key-shadow-dark:rgba(0,0,0,0.4);--text-dark:#e0e0e0;--text-secondary-dark:#aaa;--accent-dark:#007bff;--accent-darker-dark:#0056b3;--accent-text-dark:#fff;--number-text-dark:#58a6ff;--function-text-dark:var(--text-secondary-dark);--border-dark:#383838;--history-value-dark:var(--text-secondary-dark);--history-op-dark:#888;--history-result-dark:#58a6ff;--history-border-dark:var(--border-dark);--subtotal-text-dark:#58a6ff;--subtotal-border-dark:var(--history-border-dark);--edit-border-dark:var(--accent-dark);--confirm-dark:#6fcf97;--cancel-dark:#eb5757;--confirm-hover-bg-dark:#2a3a2f;--cancel-hover-bg-dark:#3a2a2a;--edit-input-bg-dark:#444;--history-font-size:16px}html{font-size:clamp(0.75rem,1.8vmin,1.125rem)}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI','Arial',sans-serif}body{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:var(--bg-light);transition:background-color .3s ease;padding:.625rem;font-size:1rem}body.dark-theme{background-color:var(--bg-dark)}body.dark-theme .calculator,body.dark-theme .history-container{background-color:var(--calc-bg-dark);box-shadow:0 10px 30px rgba(0,0,0,0.5)}body.dark-theme .display{background-color:var(--display-bg-dark);border-bottom-color:var(--border-dark)}body.dark-theme .current-calculation,body.dark-theme .result{color:var(--text-dark)}body.dark-theme .mode-buttons{background:0;border-bottom-color:var(--border-dark)}body.dark-theme .mode-btn,body.dark-theme .theme-toggle-btn{color:var(--text-secondary-dark);background:var(--key-bg-dark);box-shadow:0 2px 4px var(--key-shadow-dark)}body.dark-theme .mode-btn:hover:not(:disabled),body.dark-theme .theme-toggle-btn:hover{background-color:#3f3f3f}body.dark-theme .mode-btn:active:not(:disabled),body.dark-theme .theme-toggle-btn:active{background-color:#4a4a4a;transform:translateY(0.0625rem);box-shadow:0 1px 2px var(--key-shadow-dark)}body.dark-theme .mode-btn:disabled{color:#666;background-color:var(--key-bg-dark);opacity:.5;cursor:not-allowed;box-shadow:none}body.dark-theme .decimal-selector.mode-btn-replacement{background:var(--key-bg-dark);box-shadow:0 2px 4px var(--key-shadow-dark);border-radius:.5rem;padding:.5rem .3125rem;min-height:2.125rem;flex:1}body.dark-theme .decimal-selector.mode-btn-replacement:hover{background-color:#3f3f3f}body.dark-theme .keypad{background:0;gap:.75rem;padding:1.25rem}body.dark-theme .key{background-color:var(--key-bg-dark);color:var(--text-dark);border:0;box-shadow:0 3px 6px var(--key-shadow-dark);transition:background-color .2s,box-shadow .2s,transform .1s ease-out}body.dark-theme .key:hover{background-color:#3f3f3f}body.dark-theme .key:active{background-color:#4a4a4a;transform:translateY(0.0625rem);box-shadow:0 1px 3px var(--key-shadow-dark)}body.dark-theme .number,body.dark-theme #decimal{color:var(--number-text-dark);background-color:var(--key-bg-dark)}body.dark-theme .operator{background-color:var(--accent-dark);color:var(--accent-text-dark);box-shadow:0 3px 6px rgba(0,123,255,0.3)}body.dark-theme .operator:hover{background-color:#0069d9}body.dark-theme .operator:active{background-color:#0056b3;transform:translateY(0.0625rem);box-shadow:0 1px 3px rgba(0,123,255,0.3)}body.dark-theme .function#percent{background-color:var(--accent-dark);color:var(--accent-text-dark);box-shadow:none}body.dark-theme .function#percent:hover{background-color:#0069d9}body.dark-theme .function#percent:active{background-color:#0056b3;transform:translateY(0.0625rem);box-shadow:none}body.dark-theme .function#clear,body.dark-theme .function#backspace{color:var(--text-secondary-dark);background-color:#383838;box-shadow:0 3px 6px var(--key-shadow-dark)}body.dark-theme .function#clear:hover,body.dark-theme .function#backspace:hover{background-color:#454545}body.dark-theme .function#clear:active,body.dark-theme .function#backspace:active{background-color:#505050;transform:translateY(0.0625rem);box-shadow:0 1px 3px var(--key-shadow-dark)}body.dark-theme .tall{background-color:var(--accent-darker-dark);color:var(--accent-text-dark);box-shadow:0 3px 6px rgba(0,86,179,0.4)}body.dark-theme .tall:hover{background-color:#004085}body.dark-theme .tall:active{background-color:#036;transform:translateY(0.0625rem);box-shadow:0 1px 3px rgba(0,86,179,0.4)}body.dark-theme .history-item-value{color:var(--history-value-dark)}body.dark-theme .history-item-operator{color:var(--history-op-dark)}body.dark-theme .result-value{color:var(--history-result-dark)}body.dark-theme .result-item{border-top-color:var(--history-border-dark)}body.dark-theme .subtotal-value{color:var(--subtotal-text-dark)}body.dark-theme .subtotal-item{border-top-color:var(--subtotal-border-dark)}body.dark-theme .history-item:not(.editing):hover{background-color:#2a2a2a}body.dark-theme .history-title{color:var(--text-dark);border-bottom-color:var(--border-dark)}body.dark-theme .decimal-selector .decimal-label{color:var(--text-secondary-dark)}body.dark-theme .decimal-selector .decimal-input{background-color:#3f3f3f;color:var(--text-dark);border-color:var(--border-dark)}body.dark-theme .history-edit-input{border-color:var(--edit-border-dark);background-color:var(--edit-input-bg-dark);color:var(--text-dark);font-size:var(--history-font-size)}body.dark-theme .history-edit-operator{border-color:var(--edit-border-dark);background-color:var(--edit-input-bg-dark);color:var(--text-dark);font-size:var(--history-font-size)}body.dark-theme .history-edit-confirm{color:var(--confirm-dark)}body.dark-theme .history-edit-cancel{color:var(--cancel-dark)}body.dark-theme .history-edit-confirm:hover{background-color:var(--confirm-hover-bg-dark)}body.dark-theme .history-edit-cancel:hover{background-color:var(--cancel-hover-bg-dark)}body.dark-theme .history-item-current .history-item-value{color:var(--text-dark)}body.dark-theme .history-action-btn{color:var(--text-secondary-dark);font-size:.875rem}body.dark-theme .history-action-btn:hover{color:var(--text-dark);background-color:#4a4a4a}body.dark-theme .history-delete-btn:hover{color:var(--cancel-dark);background-color:var(--cancel-hover-bg-dark)}.calculator-container{width:100%;padding:0;display:flex;justify-content:center}.calculator{background-color:var(--calc-bg-light);border-radius:1.875rem;overflow:hidden;box-shadow:0 .9375rem 2.5rem rgba(0,0,0,0.08)}.display{background-color:var(--display-bg-light);padding:1.875rem 1.25rem .9375rem 1.25rem;text-align:right;border-bottom:0}.calculator .display .calculation-history{font-size:var(--history-font-size);margin-bottom:.3125rem;word-wrap:break-word;text-align:right;padding-right:.3125rem;min-height:1.25rem}.current-calculation{font-size:1.25rem;color:var(--text-secondary-light);margin-bottom:.3125rem;word-wrap:break-word;min-height:1.5625rem}.result{font-size:clamp(2rem,7vmin,3rem);font-weight:500;color:var(--text-light);word-wrap:break-word;min-height:clamp(3rem,9vmin,3.4375rem)}.mode-buttons{display:flex;background:0;border-bottom:0;padding:.625rem .9375rem;gap:.3125rem}.mode-btn,.theme-toggle-btn{flex:1;border:0;background:var(--key-bg-light);padding:.5rem .3125rem;font-size:.8125rem;color:var(--text-secondary-light);cursor:pointer;transition:background-color .2s,color .2s,opacity .2s,box-shadow .2s,transform .1s ease-out;border-radius:.625rem;text-align:center;display:flex;align-items:center;justify-content:center;min-height:2.125rem;box-shadow:0 .1875rem .3125rem var(--key-shadow-light)}.mode-btn svg{width:1.125rem;height:1.125rem;vertical-align:middle}.mode-btn:hover:not(:disabled),.theme-toggle-btn:hover{background-color:#f0f0f0}.mode-btn:active:not(:disabled),.theme-toggle-btn:active{background-color:#e8e8e8;box-shadow:0 .0625rem .125rem var(--key-shadow-light);transform:translateY(0.0625rem)}.mode-btn:disabled{color:#bbb;background:var(--key-bg-light);cursor:not-allowed;opacity:.6;box-shadow:none}.mode-btn:disabled:hover{background-color:var(--key-bg-light)}.decimal-selector.mode-btn-replacement{flex:1;display:flex;align-items:center;justify-content:center;padding:.3125rem;gap:.3125rem;border-radius:.625rem;cursor:default;transition:background-color .3s;min-width:5rem;min-height:2.125rem;background-color:#f8f8f8;box-shadow:inset 0 .0625rem .1875rem rgba(0,0,0,0.06)}.decimal-selector.mode-btn-replacement:hover{background-color:#f0f0f0}.decimal-selector .decimal-label{margin-right:0;font-size:.75rem;color:var(--text-secondary-light)}.decimal-selector .decimal-input{width:2.5rem;border:1px solid #d9d9d9;border-radius:.25rem;padding:.125rem .1875rem;text-align:center;font-size:.75rem;background-color:#fff}.keypad{display:grid;grid-template-columns:repeat(4,1fr);gap:.75rem;padding:1.25rem;background:0}.key{border:0;background-color:var(--key-bg-light);padding:1.125rem 0;font-size:1.25rem;cursor:pointer;transition:background-color .2s,box-shadow .2s,transform .1s ease-out;border-radius:.9375rem;box-shadow:0 .25rem .5rem var(--key-shadow-light);color:var(--text-light)}.key:hover{background-color:#f8f8f8}.key:active{background-color:#f0f0f0;box-shadow:0 .125rem .25rem var(--key-shadow-light);transform:translateY(0.0625rem)}.number,#decimal{color:var(--number-text-light)}.operator,.function#percent{background-color:var(--accent-light);color:var(--accent-text-light);box-shadow:0 .3125rem .625rem .0625rem rgba(173,226,255,0.5)}.operator:hover,.function#percent:hover{background-color:#cef}.operator:active,.function#percent:active{background-color:#b8e6ff;box-shadow:0 .125rem .3125rem rgba(173,226,255,0.5);transform:translateY(0.0625rem)}.function#clear,.function#backspace{color:var(--function-text-light);background-color:#f0f0f0;box-shadow:0 .25rem .5rem rgba(0,0,0,0.05)}.function#clear:hover,.function#backspace:hover{background-color:#e8e8e8}.function#clear:active,.function#backspace:active{background-color:#e0e0e0;box-shadow:0 .125rem .25rem rgba(0,0,0,0.05);transform:translateY(0.0625rem)}.tall{grid-row:span 2;background-color:var(--accent-darker-light);color:var(--accent-text-equals-light);box-shadow:0 .3125rem .625rem .0625rem rgba(25,172,255,0.55)}.tall:hover{background-color:#1c9ffc}.tall:active{background-color:#168cd9;box-shadow:0 .125rem .3125rem rgba(25,172,255,0.55);transform:translateY(0.0625rem)}.wide{grid-column:span 2}.history-item{display:flex;justify-content:flex-end;align-items:center;width:100%;padding:.1875rem .3125rem;margin-bottom:.0625rem;border-radius:.25rem;transition:background-color .2s;position:relative;cursor:pointer;min-height:1.25rem}.history-item:not(.editing):hover{background-color:#f5f5f5}.history-value-container{flex:1 1 auto;text-align:right;margin-right:.5rem}.history-operator-container{flex:0 0 1.5625rem;text-align:center}.history-item-value{font-family:'Consolas','Menlo',monospace;color:var(--history-value-light);font-size:var(--history-font-size)}.history-item-operator{color:var(--history-op-light);font-size:var(--history-font-size)}.history-edit-container{display:flex;align-items:center;width:100%;padding:.0625rem 0}.history-edit-input{flex:1;border:1px solid var(--edit-border-light);border-radius:.25rem;padding:.1875rem .3125rem;font-size:var(--history-font-size);text-align:right;font-family:'Consolas','Menlo',monospace;margin-right:.5rem;min-width:5rem;background-color:var(--key-bg-light);color:var(--text-light)}.history-edit-operator{width:2.8125rem;border:1px solid var(--edit-border-light);border-radius:.25rem;padding:.1875rem .125rem;font-size:var(--history-font-size);text-align:center;appearance:none;background-color:var(--key-bg-light);color:var(--text-light);cursor:pointer}.history-edit-buttons{display:flex;align-items:center;margin-left:.625rem;gap:.3125rem}.history-edit-confirm,.history-edit-cancel{border:0;background-color:transparent;cursor:pointer;font-size:1.125rem;padding:0 .25rem;border-radius:.1875rem;line-height:1;transition:background-color .2s}.history-item-current .history-item-value{color:var(--text-light);font-style:normal;font-size:var(--history-font-size)}.history-item-current:hover{background-color:transparent;cursor:default}.subtotal-item{padding-top:.25rem;margin-top:.25rem;border-top:1px dashed var(--subtotal-border-light);cursor:default;display:flex;justify-content:flex-end;align-items:center;width:100%;min-height:1.25rem}.subtotal-item:hover{background-color:transparent}.subtotal-value{font-weight:500;color:var(--subtotal-text-light);font-size:calc(var(--history-font-size) + 1px);font-family:'Consolas','Menlo',monospace;text-align:right}.result-item{padding-top:.25rem;margin-top:.25rem;border-top:1px dashed var(--history-border-light);cursor:default;display:flex;justify-content:flex-end;align-items:center;width:100%;min-height:1.25rem}.result-item:hover{background-color:transparent}.result-value{font-weight:600;color:var(--history-result-light);font-size:calc(var(--history-font-size) + 2px);font-family:'Consolas','Menlo',monospace;text-align:right}.history-item-actions{display:flex;align-items:center;opacity:0;transition:opacity .2s ease-in-out;margin-left:.625rem;gap:.25rem}.history-item:not(.editing):hover .history-item-actions{opacity:1}.history-action-btn{background:0;border:0;cursor:pointer;padding:.0625rem .1875rem;font-size:.875rem;line-height:1;border-radius:.1875rem;color:var(--text-secondary-light);transition:background-color .2s,color .2s}.history-action-btn:hover{color:var(--text-light);background-color:#e0e0e0}.history-delete-btn:hover{color:var(--cancel-light);background-color:var(--cancel-hover-bg-light)}body.dark-theme .history-delete-btn:hover{color:var(--cancel-dark);background-color:var(--cancel-hover-bg-dark)}.history-item.editing .history-item-actions{display:none}.history-item{justify-content:space-between}.history-item-content{display:flex;justify-content:flex-end;align-items:center;flex-grow:1}.history-value-container{margin-right:0;flex:1 1 auto;text-align:right}.history-operator-container{margin-left:.5rem}@media(max-width:767px){.history-container{display:none}.calculator{width:95vw;max-width:26rem;margin:0 auto}.calculator .display .calculation-history{display:block;max-height:clamp(3.75rem,12vh,5rem);overflow-y:auto;scrollbar-width:thin;scrollbar-color:#ccc transparent;font-size:var(--history-font-size)}.calculator .display .calculation-history::-webkit-scrollbar{width:.25rem}.calculator .display .calculation-history::-webkit-scrollbar-thumb{background-color:#ccc;border-radius:.125rem}body.dark-theme .calculator .display .calculation-history{scrollbar-color:#555 transparent}body.dark-theme .calculator .display .calculation-history::-webkit-scrollbar-thumb{background-color:#555}#history{display:none}#history-display{display:block}[id^="kofi-widget-overlay-"]{display:none!important}}@media(min-width:768px){.calculator-container{width:90vw;max-width:53.125rem;min-width:38.75rem;display:flex;gap:clamp(0.9375rem,2vw,1.5625rem);align-items:flex-start;padding:0;margin:0 auto}.calculator{flex:0 1 22.5rem;min-width:18.75rem;border-radius:1.5625rem;width:auto;max-width:none;margin:0}.history-container{background-color:var(--history-bg-light);border-radius:1.25rem;padding:1.25rem;flex:1 1 auto;min-width:17.5rem;display:flex;flex-direction:column;overflow:hidden;max-height:clamp(28.125rem,80vh,34.375rem);transition:background-color .3s ease}body.dark-theme .history-container{background-color:var(--history-bg-dark)}.history-title{display:block;font-size:1rem;font-weight:500;color:var(--text-light);margin-bottom:.625rem;padding-bottom:.5rem;border-bottom:1px solid var(--border-light);text-align:center;transition:color .3s ease,border-color .3s ease;flex-shrink:0}body.dark-theme .history-title{color:var(--text-dark);border-bottom-color:var(--border-dark)}.history-container .calculation-history{display:block;flex-grow:1;overflow-y:auto;margin-bottom:0;padding-right:.5rem;scrollbar-width:thin;scrollbar-color:#ccc var(--history-bg-light)}body.dark-theme .history-container .calculation-history{scrollbar-color:#555 var(--history-bg-dark)}.history-container .calculation-history::-webkit-scrollbar{width:.375rem}.history-container .calculation-history::-webkit-scrollbar-track{background:transparent}.history-container .calculation-history::-webkit-scrollbar-thumb{background-color:#ccc;border-radius:.1875rem}body.dark-theme .history-container .calculation-history::-webkit-scrollbar-thumb{background-color:#555}.calculator .display .calculation-history{display:none}#history{display:block}#history-display{display:none}}